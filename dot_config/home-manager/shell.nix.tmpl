{ pkgs, ... }:
{
  home.packages = with pkgs; [
    zinit # plugin manager
    atuin # better zsh history
    fd # better find
    cod # turn any --help into completion
    tree # pretty print directories
    zoxide # z on steroids
    neofetch # flexx your OS
    silver-searcher # ag
    eza # maintained fork of exa
    (nerdfonts.override { fonts = [ "JetBrainsMono" ]; })
    diff-so-fancy # fancy diffs ( for git )
    tealdeer # tldr in rust
    ripgrep # better grep
    meld # gui differ
    banner # print big banners
    figlet # better banners
    toilet # even better banners
  ];

  programs = {
    atuin = {
      enable = true;
      enableZshIntegration = true;
    };
    bat.enable = true;
    fzf = {
      enable = true;
      enableZshIntegration = true;
      # make fzf search hidden files too
      defaultCommand = "ag --hidden --ignore .git -g '' ";
    };
    htop.enable = true;
    navi = {
      enable = true;
      enableZshIntegration = true;
    };
    oh-my-posh = {
      enable = true;
      enableZshIntegration = true;
      settings = builtins.fromJSON(
        builtins.unsafeDiscardStringContext(
          builtins.readFile "/home/{{ .username }}/.config/oh-my-posh/bubbles-white.omp.json"
      ));
    };
    thefuck.enable = true;
    zsh = {
      enable = true;
      autosuggestion = {
        enable = true;
        highlight = "fg=#6f6c5d";
      };
      completionInit = ''
        zinit ice lucid atload'bindkey -v' multisrc'completion/completion.plugin.zsh editor/editor.plugin.zsh'
        zinit load belak/zsh-utils
      '';
      history = {
        path = "$HOME/.histfile";
        save = 10000;
        size = 10000;
      };
      sessionVariables = {
        FZF_FINDER_EDITOR_BINDKEY="^[e";
        FZF_FINDER_PAGER_BINDKEY="^[r";
        # make fzf finder plugin search hidden files too
        FZF_FINDER_FD_OPTS="--hidden -t f";
        # print path before cding for zoxide
        _ZO_ECHO = 1;
      };
      shellAliases = {
        # HOME MANAGER
        hm = "home-manager";
        hms = "home-manager switch";
        # CHEZMOI
        cz = "chezmoi";
        cza = "chezmoi apply";
        czu = "chezmoi update";
        # SHELL TOOLS
        # eza is a maintained fork of exa
        exa = "eza";
        # compatibility fix for latest versions of eza  with zsh-exa
        ls = "eza --group-directories-first --icons --color-scale all";
        # VS CODE
        c = "code";
        ci = "code-insiders";
      };
      initExtraBeforeCompInit = ''
        source $HOME/.init.zsh
      '';
      initExtra = ''
        source $HOME/.plugins.zsh
        if [[ -f ~/.secrets ]]; then
          source ~/.secrets
        fi
        if [[ -f ~/.profile ]]; then
          source ~/.profile
        fi
      '';
    };
    zoxide = {
      enable = true;
      enableZshIntegration = true;
    };
  };
}